# SoapTool - 薬歴コメントテンプレート管理ツール

薬剤師向けの薬歴コメント作成支援ツールです。定型文テンプレートを管理し、Alt+Vキーで素早く入力できます。

## 主な機能

- **テンプレート管理**: GUI上でテンプレートの追加・編集・削除・並び替え
- **クイック入力**: Alt+Vキーで選択したテンプレートを貼り付け
- **タブナビゲーション**: [TAB]マーカーによるフォーム間の移動
- **AI連携**: Geminiを使ったテンプレート自動生成

## 使用方法

### 1. 基本操作

1. `MyLauncher.ahk` を実行
2. 表示されたボタンから使用したいテンプレートを選択
3. 「現在：テンプレート名」が表示されることを確認
4. 入力したい場所で `Alt+V` を押下してテンプレートを貼り付け

### 2. テンプレート編集

1. 「編集」ボタンをクリック
2. 編集画面でテンプレートの管理操作を実行：
   - **追加**: 新しいテンプレートを作成
   - **編集**: 既存テンプレートの修正
   - **削除**: 不要なテンプレートを削除
   - **上へ/下へ**: テンプレートの表示順序を変更
   - **AI**: Geminiでテンプレート自動生成

### 3. AI機能の使用

1. 編集画面で「AI」ボタンをクリック
2. 自動的にGeminiが開き、プロンプトがクリップボードにコピーされます
3. Geminiのチャット欄にプロンプトを貼り付け
4. 生成されたテンプレートを `templates.txt` に追加
5. 編集画面を閉じて再度開くとボタンに反映されます

## テンプレート形式

```
テンプレート名::
患者の主観的な訴えや服薬状況
[TAB]客観情報 処方区分 副作用の有無
[TAB]アセスメント（評価）
[TAB]指導内容と次回確認事項
```

### [TAB]マーカーの使用方法

- **同一行の[TAB]**: タブキーとして動作（フィールド間移動）
- **改行で囲まれた[TAB]**: ブロック単位で貼り付け後にタブキー送信

## ファイル構成

- `MyLauncher.ahk` - メインプログラム
- `templates.txt` - テンプレートデータ（自動生成）
- `prompt.txt` - AI生成用プロンプト（BOM付きUTF-8推奨）
- `CLAUDE.md` - 開発者向けドキュメント

## 必要環境

- Windows OS
- AutoHotkey v1.1以上

## 注意事項

- prompt.txtは文字化けを防ぐため、BOM付きUTF-8で保存してください
- ランチャーウィンドウは常に最前面に表示されます
- テンプレート名は4文字以内を推奨（ボタンサイズの関係）